{% extends "base.html" %}

{% block title %}Historical Data{% endblock %}

{% block content %}
<h1>Historical Stock Data</h1>

<!-- Input Section -->
<div class="card mb-4">
    <div class="card-body">
        <form method="POST">
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <input type="text" name="symbol" class="form-control" placeholder="Enter stock symbol" required>
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary">View History</button>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="mb-4">
    <h2>Historical Data for {{ symbol }} from {{ history_data.start_date }} to {{ history_data.end_date }}</h2>
</div>
{% if history_data %}
<table class="table table-striped table-bordered">
    <thead class="table-dark">
        <tr>
            <th>Date</th>
            <th>Open</th>
            <th>High</th>
            <th>Low</th>
            <th>Close</th>
            <th>Volume</th>
        </tr>
    </thead>
    <tbody>
        {% for row in history_data.data %}
        <tr>
            <td>{{ row.date.strftime("%Y-%m-%d") }}</td>
            <td>{{ row.open }}</td>
            <td>{{ row.high }}</td>
            <td>{{ row.low }}</td>
            <td>{{ row.close }}</td>
            <td>{{ row.volume }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Pagination -->
<nav>
    <ul class="pagination">
        <li class="page-item {% if history_data.page == 1 %}disabled{% endif %}">
            <a class="page-link" href="?symbol={{ symbol }}&page={{ history_data.page - 1 }}">Previous</a>
        </li>

        {% for p in range(1, history_data.total_pages + 1) %}
        <li class="page-item {% if p == history_data.page %}active{% endif %}">
            <a class="page-link" href="?symbol={{ symbol }}&page={{ p }}">{{ p }}</a>
        </li>
        {% endfor %}

        <li class="page-item {% if history_data.page == history_data.total_pages %}disabled{% endif %}">
            <a class="page-link" href="?symbol={{ symbol }}&page={{ history_data.page + 1 }}">Next</a>
        </li>
    </ul>
</nav>
{% endif %}
{% endblock %}